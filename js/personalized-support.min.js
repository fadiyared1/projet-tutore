jQuery(document).ready(function ($) {
	sendFeedbackOnClick($);

	feedbackExplanation($);
});

function feedbackExplanation($) {
	$(".more").each(function (i, obj) {
		var hintObj = $(obj);
		var toolTip = hintObj.next(".complete");
		hintObj.on('click', function () {
			if (toolTip.is(':visible')) {
				toolTip.hide();
				hintObj.text("Cliquer pour plus de détails")
			}
			else {
				toolTip.show();
				hintObj.text("Réduire")
			}
		});
	});
}

function sendFeedbackOnClick($) {
	$('.feedback-container').each(function (i, container) {
		$(container).find('.feedback-button').each(function (j, input) {
			let dataset = container.dataset;
			$(input).click(function () {
				dataset['value'] = j + 1;
				$.ajax({

					url: personalizedSupport.ajaxUrl,
					data: {
						'action': personalizedSupport.sendFeedback,
						'dataset': dataset,
						'nonce': personalizedSupport.nonce
					},
					success: function (data) {
						// This outputs the result of the ajax request
						console.log(data);
					},
					error: function (errorThrown) {
						console.log(errorThrown);
					}
				});
			});
		});
	});
}
