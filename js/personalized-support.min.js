jQuery(document).ready(function ($) {
	sendFeedbackOnClick($);

	feedbackExplanation($);
});

function feedbackExplanation($) {
	$(".more").toggle(function () {
		$(this).text("Réduire").siblings(".complete").show();
	}, function () {
		$(this).text("Cliquer pour plus de détails").siblings(".complete").hide();
	});
}

function sendFeedbackOnClick($) {
	$('.feedback-container').each(function (i, container) {
		var dataset = container.dataset;

		$(container).children().each(function (j, option) {
			dataset['value'] = option.value;
			$(option).click(function () {
				$.ajax({
					url: personalizedSupport.ajaxUrl,
					data: {
						'action': personalizedSupport.sendFeedback,
						'dataset': dataset,
						'nonce': personalizedSupport.nonce
					},
					success: function (data) {
						// This outputs the result of the ajax request
						console.log(data);
					},
					error: function (errorThrown) {
						console.log(errorThrown);
					}
				});
			});
		});
	});
}
